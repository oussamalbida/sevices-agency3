"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3761],{6108:function(e,t,i){i.d(t,{z:function(){return g}});var n=i(96082),r=i(50361),l=i.n(r),a=i(67294),o=i(26629),u=i(43835),s=i(600),d=i(60809),p=i(10510),c=i(24703);let f=(e,t)=>{let i="".concat(p.ny,"/api/v1/image/pinned/").concat(e);return(0,o.uz)(i,{},{headers:{"X-CSRF-Token":t}})},g=()=>{let{token:e}=(0,c.EC)(),t=(0,s.Z)(),i=(0,n.D)({mutationFn:t=>{let{id:i}=t;return f(i,e)},onSuccess:(e,i)=>{let{id:n}=i,r=t.mutate(d.O.Images(),e=>e.pinterest_filter&&1===(0,u.w2)(e.pinterest_filter),t=>{let i=t.results.findIndex(e=>e.id===n);if(t.results[i]){let n=l()(t),r=(0,u.w2)(n.results[i].pinterest_viewed_user_remaining,0),a=(0,u.w2)(n.results[i].pinterest_counts_required,0)-e.count,o=n.pinterest_totals.user_remaining;return n.results[i].pinterest_viewed_user_remaining=Math.max(0,a),n.results[i].pinterest_counts_required=Math.max(0,a),n.pinterest_totals.user_remaining=o-(r-Math.max(0,a)),0===a&&(n.results.splice(i,1),n.total-=1),n}return null});return r.commit(),{transaction:r}},onError:(e,t,i)=>{let{transaction:n}=i;n.rollback()}});return{set:(0,a.useCallback)(e=>i.mutate({id:e}),[i])}}},36377:function(e,t,i){i.d(t,{R:function(){return n}});let n=6},74480:function(e,t,i){var n=i(85893),r=i(93967),l=i.n(r),a=i(67294),o=i(88095),u=i(13962),s=i(77977),d=i(400),p=i(32761),c=i(47533);let f=o.ZP.span.withConfig({componentId:"sc-524f6b96-0"})(["margin:auto;height:18px;position:relative;&:before{content:'';background:",";mask:url(",") center no-repeat;height:18px;width:20px;padding-left:2px;display:inline-block;animation:scaleTick;animation-duration:0.3s;animation-timing-function:linear;animation-fill-mode:forwards;}"],s.Z.white,d.ZP.SvgTickCurve),g=(0,o.ZP)(c.Z).withConfig({componentId:"sc-524f6b96-1"})(["&.saving,&.completed{background:",";color:",";}"],s.Z.purple,s.Z.white),v=a.forwardRef((e,t)=>{let{status:i,active:r,className:a,...o}=e;return(0,n.jsx)(g,{ref:t,...o,className:l()(a,i,{active:r}),children:"pending"===i?(0,n.jsx)("span",{children:(0,n.jsx)(u.c,{i18nKey:"savebutton-001",children:"Save"})}):"saving"===i?(0,n.jsx)(p.Z,{height:8,$color:"white"}):"completed"===i?(0,n.jsx)(f,{}):null})});v.displayName="SaveButton",t.Z=v},93104:function(e,t,i){var n=i(88095),r=i(91648);let l=n.ZP.div.withConfig({componentId:"sc-f10991e5-0"})(["position:absolute;transition:opacity 0.2s ease-in-out;display:flex;flex-wrap:wrap;overflow:hidden;pointer-events:none;> *{pointer-events:auto;margin:2px;}&.full{inset:0;top:0;left:0;right:0;bottom:0;align-items:center;justify-content:center;}&.top{top:0;padding-top:4px;}&.left{left:0;padding-left:4px;}&.bottom{bottom:0;padding-bottom:4px;}&.right{right:0;padding-right:4px;}&.justified{left:0;right:0;padding-left:4px;padding-right:4px;}&.reverse{flex-wrap:wrap-reverse;}&.has-group{flex-wrap:nowrap;}.grouped{display:flex;flex-wrap:wrap;margin:0;&.left{justify-content:flex-start;}&.right{justify-content:flex-end;}> *{pointer-events:auto;margin:2px;}}.filler{pointer-events:none;flex-grow:1;}@media (hover:hover) and (pointer:fine){opacity:0;.is-popup-active &{opacity:1;}}","{opacity:1;}","{display:none;.overlay-free-link{display:none;}}&.show{opacity:1;}&.show-mobile{","{display:flex;}}&.mobile-only{display:none;","{display:flex;}}"],r.Mq,r.ai,r.ai,r.ai);t.Z=l},19504:function(e,t,i){var n=i(51068),r=i(3628),l=i(50361),a=i.n(l),o=i(67294),u=i(16550),s=i(12302),d=i(43835),p=i(82461),c=i(60809),f=i(6108),g=i(37080),v=i(24703),m=i(44185),h=i(51041),y=i(40402),b=i(65636),_=i(24880),w=i(3584),x=i(44500),k=i(79273),M=i(54911);let C={};t.Z=function(e,t,i){var l,j;let{sortingMode:S,analyticsSearchData:Z,withFavorites:z=!0,withFavoriteCount:P=!0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{sortingMode:void 0,analyticsSearchData:void 0,withFavorites:!0,withFavoriteCount:!0},{data:D}=(0,v.aF)(),E=(0,v.EC)(),I=E.isReady&&E.isLoggedIn,{data:L}=(0,m.Z0)(I),{activeTeam:B}=(0,k.Z)(null==D?void 0:D.uid),{showUpgradeModal:q,showFreeSignupThrottledModal:F}=(0,M.Z)(),{setOpen:N}=(0,_.Z)(),{setOpen:T}=(0,y.Z)(),O=(0,u.k6)(),R=(0,g.R)(),{showRawpixelTeam:H}=(0,b.ZP)(),{openSignupModal:X,closeModal:U}=(0,h.ZP)(),[Y,A]=(0,o.useState)(null),[Q,W]=(0,o.useState)(!1),[K,V]=(0,o.useState)(),$=!!H&&!!(null==D?void 0:null===(l=D.access)||void 0===l?void 0:l.show_rawpixel_team),G=o.useMemo(()=>null==e?void 0:e.filter(e=>"image"===e.entity_type).map(e=>(0,d.w2)(e.id,0)).filter(Boolean),[e]),J=(0,n.N)(()=>G,[G]),ee=o.useMemo(()=>null==e?void 0:e.filter(e=>"image"!==e.entity_type).map(e=>e.id),[e]),{data:et=C}=(0,p.r)("image",J,(null==J?void 0:J.length)>0&&!S&&!1!==z),ei=(0,n.N)(()=>null==J?void 0:J.reduce((e,t)=>{var i;return e[t]=!1===P?(null==et?void 0:null===(i=et[t])||void 0===i?void 0:i.flagged)||!1:(null==et?void 0:et[t])||{count:0,flagged:!1},e},ee.reduce((e,t)=>(e[t]=!1!==P&&{count:0,flagged:!1},e),{})),[J,ee,et,P]),{set:en}=(0,p.s)(),{set:er}=(0,f.z)(),el=(0,r.NL)(),ea=o.useCallback((e,t,n)=>{if(i){i(e,t,n);return}if("image"===e.entity_type){el.setQueryData(c.O.ImageLocal({id:e.id}),{image:a()(e),placeHolderSrc:t});return}},[i,el]),eo=o.useCallback((e,t,i)=>{if("number"==typeof t&&J.includes(t)){if(D&&D.uid>0)en(D.uid,"image",t,i);else{var n,r;(null==D?void 0:null===(r=D.website_status)||void 0===r?void 0:null===(n=r.throttle_free_signup)||void 0===n?void 0:n.enabled)?F(!0):X()}}},[D,en,X,F,J]),eu=o.useCallback(function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if((null==D?void 0:D.uid)>0){e.stopPropagation(),e.preventDefault();let r=o.createRef();r.current=e.currentTarget,N(r,t,i,n)}else{var r,l;(null==D?void 0:null===(l=D.website_status)||void 0===l?void 0:null===(r=l.throttle_free_signup)||void 0===r?void 0:r.enabled)?F(!0):X()}},[N,null==D?void 0:D.uid,X,F,null==D?void 0:D.website_status]),es=o.useCallback((e,t,i,n)=>{e.stopPropagation(),e.preventDefault();let r=o.createRef();r.current=e.currentTarget,T(r,t,i,n,Z)},[T,Z]),ed=o.useCallback((e,i,n,r)=>{if(D&&D.uid>0){if(e.stopPropagation(),e.preventDefault(),"project"!==n||!s.Q[null==i?void 0:i.entity_type])return;let{id:l}=t,a=(0,w.W)([i]);a.length&&R(l,a,"delete",r)}},[D,R,t]),ep=o.useCallback((e,t)=>{"number"==typeof t&&J.includes(t)&&D&&D.uid>0&&er(t)},[D,er,J]),ec=o.useCallback((e,t)=>{if("number"==typeof(null==t?void 0:t.id)&&t&&"image"===t.entity_type){if(D&&D.uid>0){var i,n,r,l,a,o,u,s;!D.is_free||D.free_premium_active||(null==t?void 0:null===(i=t.metadata)||void 0===i?void 0:i.isFreeLicense)||(null==t?void 0:null===(n=t.metadata)||void 0===n?void 0:n.isCC0License)?$||!D.is_free||D.free_premium_active||null==t||null===(r=t.metadata)||void 0===r||!r.isFreeLicense||(null==t?void 0:null===(l=t.metadata)||void 0===l?void 0:l.isCC0License)||(null==L?void 0:null===(a=L.limits)||void 0===a?void 0:a.unlimited)||!((null==L?void 0:null===(o=L.limits)||void 0===o?void 0:o.remaining)<=0)||(null==L?void 0:null===(s=L.limits)||void 0===s?void 0:null===(u=s.ids)||void 0===u?void 0:u.includes(null==t?void 0:t.id))?A(t):q({feature:x.HN,upgradeBoxType:"black"}):q({feature:x.D8,upgradeBoxType:"black",image:t})}else O.push("/user/register?destination=/image/".concat(t.id))}},[D,O,null==L?void 0:L.limits,$,q]),ef=o.useCallback((e,t)=>{W(!0),V(t)},[]),eg=o.useCallback(()=>{U(),A(void 0)},[U]),ev=!!(null==D?void 0:D.uid)&&!!t&&((null==D?void 0:null===(j=D.access)||void 0===j?void 0:j.edit_any_board)||"user"===t.owner.type&&t.owner.id===(null==D?void 0:D.uid)||!!B&&"team"===t.owner.type&&t.owner.id===B.id),em=o.useCallback(()=>{A(void 0),W(!1),V(null)},[]);return o.useMemo(()=>({onImageClick:ea,canDeleteFromProject:ev,onSaveClick:eu,onDotsMenuClick:es,onDeleteFromProjectClick:ed,onFavoriteClick:eo,onPinterestClick:ep,favorites:ei,closeModal:eg,onDownloadClick:ec,imageToDownload:Y,closeDrawer:em,onShareClick:ef,shareEntity:K,shareDrawerOpen:Q}),[ea,ev,eu,es,ed,eo,ep,ei,eg,ec,Y,em,ef,K,Q])}},13622:function(e,t,i){i.d(t,{Ay:function(){return Z},C3:function(){return C},Di:function(){return M},E2:function(){return u},EX:function(){return a},LA:function(){return p},Mm:function(){return w},PD:function(){return c},Tc:function(){return g},Vq:function(){return l},Zz:function(){return b},b4:function(){return y},b7:function(){return _},g1:function(){return d},hi:function(){return f},jB:function(){return x},km:function(){return k},lL:function(){return o},n0:function(){return v},oH:function(){return h},q1:function(){return m},ub:function(){return j},wN:function(){return s},wQ:function(){return r}});var n=i(72897);let r=40,l=8e3,a=25e6,o=78e6,u=11e3,s=8,d=16e6,p=16e6,c=6e3,f=2,g=50,v=1e4,m=4e3,h=2500,y=12,b=3,_=96,w=300,x=150,k=(0,n.sl)("svg","png","jpg","transparent_png","pdf_standard","pdf_print").asObject(),M=(0,n.sl)("jpg","png","svg").asObject(),C=(0,n.sl)("zip","pdf").asObject(),j=(0,n.sl)("set-if-missing","remove").asObject(),S={loadBestImageSizes:!0,applyMaxSize:u,applyMaxPixels:o,applyMinSize:-1},Z={jpg:{...S,format:M.jpg,modifyBackground:j["set-if-missing"],quality:.9,writeDpi:!0},svg:{...S,format:M.svg},png:{...S,format:M.png,modifyBackground:j["set-if-missing"]},transparent_png:{...S,format:M.png,modifyBackground:j.remove},pdf_standard:{...S,format:M.jpg,modifyBackground:j["set-if-missing"],quality:.9,sizeMultiplier:x/_},pdf_print:{...S,format:M.jpg,modifyBackground:j["set-if-missing"],quality:.9,sizeMultiplier:w/_}}},59538:function(e,t,i){i.d(t,{DP:function(){return u},pF:function(){return l},tk:function(){return a}});var n=i(13622),r=i(41205);let l=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"px",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"px",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.b7,a="number"==typeof e?e:parseFloat(e),o="number"==typeof t?t:parseFloat(t);if(i===r)return[a,o];let u=l/2.54,s=[a,o];switch(i){case"in":s=[a*l,o*l];break;case"cm":s=[a*u,o*u];break;case"px":s=[a,o];break;default:throw Error("Invalid unit value ".concat(i))}let[d,p]=s;switch(r){case"in":return[d/l,p/l];case"cm":return[d/u,p/u];case"px":return s;default:throw Error("Invalid unit value ".concat(r))}},a=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=e===n.km.png||e===n.km.jpg||e===n.km.transparent_png,a=e===n.km.pdf_print||e===n.km.pdf_standard;return{...n.Ay[e],...l&&t!==r.sY.PIXELS?{applyMinSize:n.q1}:{},...a&&t?{applyMinSize:n.oH}:{},...i}},o=(e,t,i,r,l,a)=>{let o=e*l,u=t*l;i>0&&o>i&&(u=i/o*u,o=i),i>0&&u>i&&(o=i/u*o,u=i);let s=o*u;if(r>0&&s>r){let e=Math.sqrt(r/s);o*=e,u*=e}if(a>0&&o<a&&u<a){let e=Math.max(o/a,u/a);u/=e,o/=e}let d=o/e;return u=Math.round(u),o=Math.round(o),{targetDpi:n.b7,width:e,height:t,exportWidth:o,exportHeight:u,exportDpi:n.b7*d}},u=(e,t)=>{let{applyMaxSize:i=n.E2,applyMaxPixels:l=n.lL,writeDpi:a=!1}=t||{},[u,s]=e.getDesignSize(r.sY.PIXELS,n.b7),d=e.designUnits!==r.sY.PIXELS&&!0===a?-1:"number"==typeof(null==t?void 0:t.applyMinSize)?t.applyMinSize:-1,p="number"==typeof(null==t?void 0:t.sizeMultiplier)?t.sizeMultiplier:1;!0===a&&e.designUnits!==r.sY.PIXELS&&(p=Math.min(1200,10*Math.floor(o(u,s,i,l,1e4/n.b7,-1).exportDpi/10))/n.b7);let{exportWidth:c,exportHeight:f,exportDpi:g,targetDpi:v}=o(u,s,i,l,p,d);return{designWidth:e.designWidth,designHeight:e.designHeight,designUnits:e.designUnits,targetDpi:v,sizeMultiplier:p,width:u,height:s,exportWidth:c,exportHeight:f,exportDpi:g}}}}]);